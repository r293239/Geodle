<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shaple üß© - Country Shape Guessing Game</title>
    <meta name="description" content="Identify countries by their silhouette in Shaple - a daily country shape guessing game. Test your geographical knowledge!">
    <meta name="keywords" content="country shape game, geography puzzle, silhouette guessing, daily challenge, shaple, country recognition">
    <meta name="author" content="Routele Team">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, 
                #1a1a2e 0%, 
                #16213e 25%, 
                #0f3460 50%, 
                #1a1a2e 100%);
            min-height: 100vh;
            color: #fff;
            position: relative;
        }

        /* Subtle grid background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.05) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: 1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 2;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-top: 20px;
        }

        .header h1 {
            font-size: 4rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #96ceb4, #4ecdc4, #45b7d1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 900;
            letter-spacing: 2px;
        }

        .subtitle {
            font-size: 1.4rem;
            color: #a0a0d8;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .game-container {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 30px;
            margin-bottom: 40px;
        }

        @media (max-width: 768px) {
            .game-container {
                grid-template-columns: 1fr;
            }
        }

        /* Shape Display Area */
        .shape-display {
            background: rgba(0, 0, 0, 0.6);
            border-radius: 25px;
            padding: 40px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 500px;
        }

        .shape-canvas-container {
            width: 100%;
            height: 400px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 30px;
        }

        #shapeCanvas {
            width: 100%;
            height: 100%;
            background: transparent;
        }

        .shape-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: none;
        }

        .shape-overlay-text {
            font-size: 2.5rem;
            color: rgba(255, 255, 255, 0.3);
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 4px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.5; }
        }

        .difficulty-indicator {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 20px;
        }

        .difficulty-bar {
            width: 200px;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .difficulty-progress {
            height: 100%;
            background: linear-gradient(90deg, #4ecdc4, #45b7d1);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .difficulty-text {
            font-size: 0.9rem;
            color: #a0a0d8;
            font-weight: 600;
            min-width: 80px;
        }

        /* Game Info Panel */
        .game-info {
            background: rgba(0, 0, 0, 0.6);
            border-radius: 25px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease;
        }

        .stat-item:hover {
            transform: translateY(-2px);
            border-color: rgba(78, 205, 196, 0.3);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(45deg, #96ceb4, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #a0a0d8;
            font-weight: 600;
        }

        /* Guess Input Section */
        .guess-section {
            background: rgba(0, 0, 0, 0.6);
            border-radius: 25px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 30px;
        }

        .input-container {
            position: relative;
            margin-bottom: 20px;
        }

        .guess-input {
            width: 100%;
            padding: 18px 20px;
            font-size: 1.1rem;
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid rgba(78, 205, 196, 0.3);
            border-radius: 15px;
            color: white;
            transition: all 0.3s ease;
        }

        .guess-input:focus {
            outline: none;
            border-color: #4ecdc4;
            box-shadow: 0 0 20px rgba(78, 205, 196, 0.2);
            background: rgba(255, 255, 255, 0.12);
        }

        .guess-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .suggestions-box {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.95);
            border: 1px solid rgba(78, 205, 196, 0.3);
            border-top: none;
            border-radius: 0 0 15px 15px;
            max-height: 200px;
            overflow-y: auto;
            display: none;
            z-index: 1000;
        }

        .suggestion-item {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.2s ease;
        }

        .suggestion-item:hover {
            background: rgba(78, 205, 196, 0.2);
            padding-left: 25px;
        }

        .suggestion-item:last-child {
            border-bottom: none;
        }

        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .game-button {
            padding: 16px;
            font-size: 1.1rem;
            font-weight: 600;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .submit-btn {
            background: linear-gradient(135deg, #96ceb4, #4ecdc4);
            color: white;
        }

        .submit-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(150, 206, 180, 0.4);
        }

        .skip-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .skip-btn:hover:not(:disabled) {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        .game-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        /* Guess History */
        .guesses-history {
            background: rgba(0, 0, 0, 0.6);
            border-radius: 25px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .guesses-title {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: #96ceb4;
            font-weight: 600;
        }

        .guesses-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .guess-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .guess-correct {
            border-left: 4px solid #96ceb4;
        }

        .guess-incorrect {
            border-left: 4px solid rgba(255, 255, 255, 0.2);
        }

        .guess-country {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .guess-hint {
            font-size: 0.9rem;
            color: #a0a0d8;
        }

        /* Game Over Modal */
        .game-over-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(5px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: rgba(26, 26, 46, 0.95);
            border-radius: 25px;
            padding: 50px;
            max-width: 600px;
            width: 90%;
            border: 1px solid rgba(78, 205, 196, 0.3);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.5);
            text-align: center;
            animation: modalSlide 0.5s ease;
        }

        @keyframes modalSlide {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-title {
            font-size: 2.5rem;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #96ceb4, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .modal-country {
            font-size: 3rem;
            font-weight: 800;
            margin: 30px 0;
            color: white;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .modal-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 30px 0;
        }

        .modal-stat {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
        }

        .modal-stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #4ecdc4;
            margin-bottom: 5px;
        }

        .modal-stat-label {
            font-size: 0.9rem;
            color: #a0a0d8;
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .modal-btn {
            flex: 1;
            padding: 16px;
            font-size: 1.1rem;
            font-weight: 600;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-btn-primary {
            background: linear-gradient(135deg, #96ceb4, #4ecdc4);
            color: white;
        }

        .modal-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(150, 206, 180, 0.4);
        }

        .modal-btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .modal-btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        /* Navigation Bar */
        .nav-bar {
            position: fixed;
            top: 20px;
            left: 20px;
            display: flex;
            gap: 15px;
            z-index: 1000;
        }

        .nav-btn {
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 12px 24px;
            border-radius: 20px;
            text-decoration: none;
            font-weight: 600;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            border-color: rgba(78, 205, 196, 0.5);
            box-shadow: 0 10px 25px rgba(78, 205, 196, 0.2);
        }

        /* Daily Challenge Banner */
        .daily-banner {
            background: linear-gradient(135deg, rgba(150, 206, 180, 0.2), rgba(78, 205, 196, 0.2));
            border: 1px solid rgba(150, 206, 180, 0.3);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 30px;
            text-align: center;
        }

        .daily-text {
            font-size: 1rem;
            color: #96ceb4;
            font-weight: 600;
        }

        .daily-date {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 5px;
        }

        /* Difficulty Levels */
        .difficulty-levels {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .difficulty-btn {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .difficulty-btn.active {
            background: linear-gradient(135deg, #96ceb4, #4ecdc4);
            border-color: transparent;
            box-shadow: 0 5px 15px rgba(150, 206, 180, 0.3);
        }

        .difficulty-btn:hover:not(.active) {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        /* Hint System */
        .hint-system {
            background: rgba(0, 0, 0, 0.6);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .hint-title {
            color: #ffd700;
            font-size: 1rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .hint-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .hint-btn {
            padding: 12px;
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 10px;
            color: #ffd700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .hint-btn:hover:not(:disabled) {
            background: rgba(255, 215, 0, 0.2);
            transform: translateY(-2px);
        }

        .hint-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Streak Counter */
        .streak-counter {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 20px;
            padding: 12px 20px;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
        }

        .streak-icon {
            color: #ffd700;
            font-size: 1.5rem;
            animation: flame 2s infinite;
        }

        @keyframes flame {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .streak-text {
            font-weight: 600;
        }

        .streak-number {
            color: #ffd700;
            font-weight: 800;
            font-size: 1.2rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5rem;
            }
            
            .subtitle {
                font-size: 1.1rem;
            }
            
            .game-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .shape-display {
                padding: 20px;
                min-height: 400px;
            }
            
            .shape-canvas-container {
                height: 300px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 10px;
            }
            
            .stat-number {
                font-size: 2rem;
            }
            
            .modal-content {
                padding: 30px 20px;
            }
            
            .modal-title {
                font-size: 2rem;
            }
            
            .modal-country {
                font-size: 2rem;
            }
            
            .modal-stats {
                grid-template-columns: 1fr;
            }
            
            .nav-bar {
                position: static;
                justify-content: center;
                margin-bottom: 20px;
                flex-wrap: wrap;
            }
            
            .streak-counter {
                position: static;
                margin: 20px auto;
                width: fit-content;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <div class="nav-bar">
        <a href="https://r293239.github.io/Geodle/" class="nav-btn">üè† Home</a>
        <a href="https://r293239.github.io/Geodle/path-mode" class="nav-btn">üó∫Ô∏è Routele</a>
        <a href="https://r293239.github.io/Geodle/country-mode" class="nav-btn">üåç Countryle</a>
    </div>

    <!-- Streak Counter -->
    <div class="streak-counter">
        <span class="streak-icon">üî•</span>
        <span class="streak-text">Daily Streak:</span>
        <span class="streak-number" id="streakCount">0</span>
    </div>

    <div class="container">
        <div class="header">
            <h1>Shaple üß©</h1>
            <div class="subtitle">Identify countries by their silhouette - each wrong guess sharpens the shape!</div>
        </div>

        <!-- Daily Challenge Banner -->
        <div class="daily-banner">
            <div class="daily-text">üéØ Daily Country Challenge</div>
            <div class="daily-date" id="dailyDate">Loading...</div>
        </div>

        <!-- Difficulty Selection -->
        <div class="difficulty-levels">
            <button class="difficulty-btn active" data-difficulty="easy">Easy (High Blur)</button>
            <button class="difficulty-btn" data-difficulty="medium">Medium</button>
            <button class="difficulty-btn" data-difficulty="hard">Hard (Low Blur)</button>
            <button class="difficulty-btn" data-difficulty="expert">Expert (Minimal Blur)</button>
        </div>

        <div class="game-container">
            <!-- Left Column: Shape Display -->
            <div class="shape-display">
                <div class="shape-canvas-container">
                    <canvas id="shapeCanvas"></canvas>
                    <div class="shape-overlay">
                        <div class="shape-overlay-text" id="shapeText">Country Shape</div>
                    </div>
                </div>
                
                <div class="difficulty-indicator">
                    <div class="difficulty-text" id="blurLevel">VERY BLURRED</div>
                    <div class="difficulty-bar">
                        <div class="difficulty-progress" id="blurProgress"></div>
                    </div>
                    <div class="difficulty-text">CLEAR</div>
                </div>
            </div>

            <!-- Right Column: Game Info -->
            <div class="game-info">
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-number" id="guessCount">0</div>
                        <div class="stat-label">Guesses</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="remainingGuesses">10</div>
                        <div class="stat-label">Remaining</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="score">100</div>
                        <div class="stat-label">Score</div>
                    </div>
                </div>

                <!-- Hint System -->
                <div class="hint-system">
                    <div class="hint-title">üí° Need Help?</div>
                    <div class="hint-buttons">
                        <button class="hint-btn" id="continentHint">Continent</button>
                        <button class="hint-btn" id="sizeHint">Size</button>
                        <button class="hint-btn" id="neighborHint">Neighbors</button>
                        <button class="hint-btn" id="revealHint">Reveal Letter</button>
                    </div>
                </div>

                <!-- Guess Input -->
                <div class="guess-section">
                    <div class="input-container">
                        <input type="text" id="guessInput" class="guess-input" placeholder="Enter country name..." autocomplete="off">
                        <div id="suggestions" class="suggestions-box"></div>
                    </div>
                    <div class="button-group">
                        <button id="submitGuess" class="game-button submit-btn">‚úÖ Submit Guess</button>
                        <button id="skipCountry" class="game-button skip-btn">‚è≠Ô∏è Skip Country</button>
                    </div>
                </div>

                <!-- Previous Guesses -->
                <div class="guesses-history">
                    <div class="guesses-title">Previous Guesses</div>
                    <div id="guessesList" class="guesses-list">
                        <!-- Guess items will be added here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Game Over Modal -->
    <div id="gameOverModal" class="game-over-modal">
        <div class="modal-content">
            <div class="modal-title" id="resultTitle">üéâ Country Identified!</div>
            <div class="modal-country" id="modalCountryName">COUNTRY NAME</div>
            
            <div class="modal-stats">
                <div class="modal-stat">
                    <div class="modal-stat-value" id="finalScore">0</div>
                    <div class="modal-stat-label">Final Score</div>
                </div>
                <div class="modal-stat">
                    <div class="modal-stat-value" id="totalGuesses">0</div>
                    <div class="modal-stat-label">Total Guesses</div>
                </div>
                <div class="modal-stat">
                    <div class="modal-stat-value" id="timeTaken">0s</div>
                    <div class="modal-stat-label">Time Taken</div>
                </div>
                <div class="modal-stat">
                    <div class="modal-stat-value" id="accuracy">0%</div>
                    <div class="modal-stat-label">Accuracy</div>
                </div>
            </div>

            <div class="modal-buttons">
                <button id="nextCountry" class="modal-btn modal-btn-primary">üöÄ Next Country</button>
                <button id="playAgain" class="modal-btn modal-btn-secondary">üîÑ Play Again</button>
            </div>
        </div>
    </div>

    <!-- Audio Elements -->
    <audio id="correctSound" src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3"></audio>
    <audio id="incorrectSound" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"></audio>
    <audio id="winSound" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3"></audio>

    <script>
        // Country data with silhouette paths (simplified for demo)
        // In a full implementation, you would use actual SVG paths
        const countries = [
            {
                name: "Italy",
                continent: "Europe",
                neighbors: ["France", "Switzerland", "Austria", "Slovenia"],
                area: 301340,
                description: "Boot-shaped peninsula",
                difficulty: "medium"
            },
            {
                name: "Australia",
                continent: "Oceania",
                neighbors: [],
                area: 7692024,
                description: "Island continent",
                difficulty: "easy"
            },
            {
                name: "Chile",
                continent: "South America",
                neighbors: ["Peru", "Bolivia", "Argentina"],
                area: 756102,
                description: "Long, narrow country",
                difficulty: "hard"
            },
            {
                name: "India",
                continent: "Asia",
                neighbors: ["Pakistan", "China", "Nepal", "Bhutan", "Bangladesh", "Myanmar"],
                area: 3287263,
                description: "Triangular shape",
                difficulty: "medium"
            },
            {
                name: "Madagascar",
                continent: "Africa",
                neighbors: [],
                area: 587041,
                description: "Large island off Africa",
                difficulty: "easy"
            },
            {
                name: "Japan",
                continent: "Asia",
                neighbors: [],
                area: 377975,
                description: "Archipelago of islands",
                difficulty: "medium"
            },
            {
                name: "Brazil",
                continent: "South America",
                neighbors: ["Venezuela", "Guyana", "Suriname", "French Guiana", "Colombia", "Peru", "Bolivia", "Paraguay", "Argentina", "Uruguay"],
                area: 8515767,
                description: "Largest South American country",
                difficulty: "easy"
            },
            {
                name: "Norway",
                continent: "Europe",
                neighbors: ["Sweden", "Finland", "Russia"],
                area: 323802,
                description: "Long coastline with fjords",
                difficulty: "hard"
            },
            {
                name: "Egypt",
                continent: "Africa",
                neighbors: ["Libya", "Sudan", "Israel"],
                area: 1002450,
                description: "Pyramid-shaped in the northeast",
                difficulty: "medium"
            },
            {
                name: "United States",
                continent: "North America",
                neighbors: ["Canada", "Mexico"],
                area: 9833517,
                description: "Contiguous 48 states shape",
                difficulty: "easy"
            }
        ];

        // Game state
        let currentCountry = null;
        let guesses = [];
        let remainingGuesses = 10;
        let score = 100;
        let gameActive = true;
        let blurLevel = 10; // Initial blur level
        let startTime = null;
        let streak = 0;
        let hintsUsed = 0;

        // DOM elements
        const canvas = document.getElementById('shapeCanvas');
        const ctx = canvas.getContext('2d');
        const guessInput = document.getElementById('guessInput');
        const suggestionsBox = document.getElementById('suggestions');
        const submitBtn = document.getElementById('submitGuess');
        const skipBtn = document.getElementById('skipCountry');
        const gameOverModal = document.getElementById('gameOverModal');
        const guessesList = document.getElementById('guessesList');
        const guessCountElement = document.getElementById('guessCount');
        const remainingGuessesElement = document.getElementById('remainingGuesses');
        const scoreElement = document.getElementById('score');
        const blurProgressElement = document.getElementById('blurProgress');
        const blurLevelElement = document.getElementById('blurLevel');
        const shapeTextElement = document.getElementById('shapeText');
        const streakCountElement = document.getElementById('streakCount');
        const dailyDateElement = document.getElementById('dailyDate');

        // Audio elements
        const correctSound = document.getElementById('correctSound');
        const incorrectSound = document.getElementById('incorrectSound');
        const winSound = document.getElementById('winSound');

        // Initialize canvas
        canvas.width = 800;
        canvas.height = 400;

        // Set daily date
        function updateDailyDate() {
            const now = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            dailyDateElement.textContent = now.toLocaleDateString('en-US', options);
        }

        // Initialize streak from localStorage
        function initStreak() {
            const savedStreak = localStorage.getItem('shapleStreak');
            const lastPlayed = localStorage.getItem('shapleLastPlayed');
            const today = new Date().toDateString();

            if (savedStreak && lastPlayed) {
                streak = parseInt(savedStreak);
                if (lastPlayed === today) {
                    // Already played today, keep streak
                } else if (lastPlayed === new Date(Date.now() - 86400000).toDateString()) {
                    // Played yesterday, increment streak
                    streak++;
                } else {
                    // Broken streak
                    streak = 1;
                }
            } else {
                streak = 1;
            }

            updateStreakDisplay();
            saveStreak();
        }

        function updateStreakDisplay() {
            streakCountElement.textContent = streak;
        }

        function saveStreak() {
            localStorage.setItem('shapleStreak', streak.toString());
            localStorage.setItem('shapleLastPlayed', new Date().toDateString());
        }

        // Get daily country based on date
        function getDailyCountry() {
            const today = new Date();
            const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / 86400000);
            const countryIndex = dayOfYear % countries.length;
            return countries[countryIndex];
        }

        // Initialize game
        function initGame() {
            currentCountry = getDailyCountry();
            guesses = [];
            remainingGuesses = 10;
            score = 100;
            gameActive = true;
            blurLevel = 10;
            hintsUsed = 0;
            startTime = Date.now();

            updateUI();
            drawShape();
            updateSuggestions();
            updateDailyDate();
        }

        // Draw blurred shape
        function drawShape() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Save context state
            ctx.save();
            
            // Apply blur effect by drawing multiple semi-transparent shapes
            ctx.fillStyle = 'rgba(255, 255, 255, 0.1)';
            
            // Draw base shape (simplified country outline)
            // In a real implementation, you would use actual country SVG paths
            drawCountryOutline(currentCountry.name);
            
            // Apply multiple layers for blur effect
            const blurLayers = Math.max(1, Math.floor(blurLevel / 2));
            for (let i = 0; i < blurLayers; i++) {
                const offset = Math.random() * blurLevel - blurLevel / 2;
                ctx.translate(offset, offset);
                drawCountryOutline(currentCountry.name);
            }
            
            // Restore context
            ctx.restore();
            
            // Update blur level display
            updateBlurDisplay();
        }

        // Draw simplified country outline (demo version)
        function drawCountryOutline(countryName) {
            ctx.beginPath();
            
            switch(countryName) {
                case "Italy":
                    // Boot shape
                    ctx.moveTo(400, 100);
                    ctx.lineTo(450, 150);
                    ctx.lineTo(500, 200);
                    ctx.lineTo(550, 300);
                    ctx.lineTo(500, 350);
                    ctx.lineTo(400, 300);
                    ctx.lineTo(350, 250);
                    ctx.lineTo(300, 200);
                    ctx.lineTo(350, 150);
                    ctx.closePath();
                    break;
                    
                case "Australia":
                    // Rough Australia shape
                    ctx.ellipse(400, 200, 150, 100, 0, 0, Math.PI * 2);
                    break;
                    
                case "Chile":
                    // Long vertical shape
                    ctx.moveTo(400, 50);
                    ctx.lineTo(450, 350);
                    ctx.lineTo(350, 350);
                    ctx.closePath();
                    break;
                    
                case "India":
                    // Triangular shape
                    ctx.moveTo(400, 100);
                    ctx.lineTo(500, 300);
                    ctx.lineTo(300, 300);
                    ctx.closePath();
                    break;
                    
                default:
                    // Generic oval for other countries
                    ctx.ellipse(400, 200, 120, 80, 0, 0, Math.PI * 2);
            }
            
            ctx.fill();
        }

        // Update blur display
        function updateBlurDisplay() {
            const percentage = Math.max(0, Math.min(100, 100 - (blurLevel * 10)));
            blurProgressElement.style.width = percentage + '%';
            
            // Update blur level text
            if (blurLevel >= 8) blurLevelElement.textContent = "VERY BLURRED";
            else if (blurLevel >= 5) blurLevelElement.textContent = "BLURRED";
            else if (blurLevel >= 3) blurLevelElement.textContent = "SOMEWHAT CLEAR";
            else if (blurLevel >= 1) blurLevelElement.textContent = "CLEAR";
            else blurLevelElement.textContent = "VERY CLEAR";
        }

        // Update UI
        function updateUI() {
            guessCountElement.textContent = guesses.length;
            remainingGuessesElement.textContent = remainingGuesses;
            scoreElement.textContent = score;
            
            // Update guesses list
            guessesList.innerHTML = '';
            guesses.forEach((guess, index) => {
                const guessElement = document.createElement('div');
                guessElement.className = `guess-item ${guess.correct ? 'guess-correct' : 'guess-incorrect'}`;
                guessElement.innerHTML = `
                    <div>
                        <div class="guess-country">${guess.country}</div>
                        ${!guess.correct && guess.hint ? `<div class="guess-hint">${guess.hint}</div>` : ''}
                    </div>
                    <div>${guess.correct ? '‚úÖ' : '‚ùå'}</div>
                `;
                guessesList.appendChild(guessElement);
            });
        }

        // Update suggestions
        function updateSuggestions() {
            const allCountries = countries.map(c => c.name);
            suggestionsBox.innerHTML = '';
            
            allCountries.forEach(country => {
                if (!guesses.some(g => g.country === country)) {
                    const suggestion = document.createElement('div');
                    suggestion.className = 'suggestion-item';
                    suggestion.textContent = country;
                    suggestion.addEventListener('click', () => {
                        guessInput.value = country;
                        suggestionsBox.style.display = 'none';
                    });
                    suggestionsBox.appendChild(suggestion);
                }
            });
        }

        // Handle guess submission
        function submitGuess() {
            if (!gameActive) return;
            
            const guess = guessInput.value.trim();
            if (!guess) return;
            
            // Check if already guessed
            if (guesses.some(g => g.country.toLowerCase() === guess.toLowerCase())) {
                alert('You already guessed this country!');
                return;
            }
            
            const correct = guess.toLowerCase() === currentCountry.name.toLowerCase();
            const guessObj = {
                country: guess,
                correct: correct,
                time: Date.now() - startTime
            };
            
            guesses.push(guessObj);
            remainingGuesses--;
            
            if (correct) {
                // Correct guess
                correctSound.currentTime = 0;
                correctSound.play();
                shapeTextElement.textContent = 'CORRECT! üéâ';
                gameActive = false;
                setTimeout(() => showGameOver(true), 1000);
            } else {
                // Wrong guess
                incorrectSound.currentTime = 0;
                incorrectSound.play();
                shapeTextElement.textContent = 'TRY AGAIN!';
                
                // Reduce blur level (sharpen shape)
                blurLevel = Math.max(0, blurLevel - 2);
                
                // Reduce score
                score = Math.max(0, score - 10);
                
                // Provide hint
                if (remainingGuesses > 0) {
                    guessObj.hint = getHint();
                }
                
                // Check if out of guesses
                if (remainingGuesses <= 0) {
                    gameActive = false;
                    setTimeout(() => showGameOver(false), 1000);
                }
                
                drawShape();
            }
            
            guessInput.value = '';
            suggestionsBox.style.display = 'none';
            updateUI();
            updateSuggestions();
        }

        // Get hint for wrong guess
        function getHint() {
            const hints = [
                `Continent: ${currentCountry.continent}`,
                `Area: ${currentCountry.area.toLocaleString()} km¬≤`,
                `Neighbors: ${currentCountry.neighbors.slice(0, 3).join(', ')}${currentCountry.neighbors.length > 3 ? '...' : ''}`,
                currentCountry.description
            ];
            
            return hints[Math.floor(Math.random() * hints.length)];
        }

        // Show game over modal
        function showGameOver(won) {
            const modalTitle = document.getElementById('resultTitle');
            const modalCountry = document.getElementById('modalCountryName');
            const finalScore = document.getElementById('finalScore');
            const totalGuesses = document.getElementById('totalGuesses');
            const timeTaken = document.getElementById('timeTaken');
            const accuracy = document.getElementById('accuracy');
            
            if (won) {
                modalTitle.textContent = 'üéâ Country Identified!';
                winSound.play();
                streak++;
                saveStreak();
            } else {
                modalTitle.textContent = '‚ùå Out of Guesses!';
            }
            
            modalCountry.textContent = currentCountry.name.toUpperCase();
            finalScore.textContent = score;
            totalGuesses.textContent = guesses.length;
            timeTaken.textContent = Math.round((Date.now() - startTime) / 1000) + 's';
            accuracy.textContent = won ? '100%' : '0%';
            
            updateStreakDisplay();
            gameOverModal.style.display = 'flex';
        }

        // Skip to next country
        function skipCountry() {
            if (!gameActive) return;
            
            // Get new country that hasn't been guessed
            const guessedCountries = guesses.map(g => g.country.toLowerCase());
            const availableCountries = countries.filter(c => 
                !guessedCountries.includes(c.name.toLowerCase())
            );
            
            if (availableCountries.length > 0) {
                currentCountry = availableCountries[Math.floor(Math.random() * availableCountries.length)];
                blurLevel = 10;
                drawShape();
                shapeTextElement.textContent = 'NEW COUNTRY';
            } else {
                // All countries guessed
                gameActive = false;
                showGameOver(false);
            }
        }

        // Event listeners
        guessInput.addEventListener('input', () => {
            const value = guessInput.value.toLowerCase();
            const suggestions = document.querySelectorAll('.suggestion-item');
            
            if (value.length > 0) {
                suggestionsBox.style.display = 'block';
                suggestions.forEach(suggestion => {
                    suggestion.style.display = suggestion.textContent.toLowerCase().includes(value) ? 'block' : 'none';
                });
            } else {
                suggestionsBox.style.display = 'none';
            }
        });

        guessInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                submitGuess();
            }
        });

        submitBtn.addEventListener('click', submitGuess);
        skipBtn.addEventListener('click', skipCountry);

        // Modal buttons
        document.getElementById('nextCountry').addEventListener('click', () => {
            gameOverModal.style.display = 'none';
            initGame();
        });

        document.getElementById('playAgain').addEventListener('click', () => {
            gameOverModal.style.display = 'none';
            initGame();
        });

        // Difficulty buttons
        document.querySelectorAll('.difficulty-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                // Adjust initial blur level based on difficulty
                const difficulty = btn.dataset.difficulty;
                switch(difficulty) {
                    case 'easy': blurLevel = 12; break;
                    case 'medium': blurLevel = 8; break;
                    case 'hard': blurLevel = 4; break;
                    case 'expert': blurLevel = 1; break;
                }
                
                if (gameActive) {
                    drawShape();
                }
            });
        });

        // Hint buttons
        document.getElementById('continentHint').addEventListener('click', () => {
            if (!gameActive || hintsUsed >= 3) return;
            alert(`Continent: ${currentCountry.continent}`);
            score = Math.max(0, score - 20);
            hintsUsed++;
            updateUI();
        });

        document.getElementById('sizeHint').addEventListener('click', () => {
            if (!gameActive || hintsUsed >= 3) return;
            alert(`Area: ${currentCountry.area.toLocaleString()} km¬≤`);
            score = Math.max(0, score - 20);
            hintsUsed++;
            updateUI();
        });

        document.getElementById('neighborHint').addEventListener('click', () => {
            if (!gameActive || hintsUsed >= 3) return;
            const neighbors = currentCountry.neighbors.slice(0, 3).join(', ');
            alert(`Neighbors: ${neighbors}${currentCountry.neighbors.length > 3 ? '...' : ''}`);
            score = Math.max(0, score - 20);
            hintsUsed++;
            updateUI();
        });

        document.getElementById('revealHint').addEventListener('click', () => {
            if (!gameActive || hintsUsed >= 3) return;
            const firstLetter = currentCountry.name.charAt(0);
            alert(`Starts with: ${firstLetter}`);
            score = Math.max(0, score - 30);
            hintsUsed++;
            updateUI();
        });

        // Close suggestions when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.input-container')) {
                suggestionsBox.style.display = 'none';
            }
        });

        // Initialize game
        initGame();
        initStreak();
        updateDailyDate();
    </script>
</body>
</html>
