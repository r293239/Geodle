<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Routele</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    <script src="country-data.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(-45deg, #1a1a2e, #16213e, #0f3460, #533483, #7209b7, #a663cc);
            background-size: 400% 400%;
            animation: gradientShift 20s ease infinite;
            min-height: 100vh;
            color: #fff;
            position: relative;
            overflow-x: hidden;
            transition: all 1s ease;
        }

        body.theme-ocean {
            background: linear-gradient(-45deg, #001427, #012a4a, #2a6f97, #0077be, #00b4d8, #90e0ef);
            background-size: 400% 400%;
            animation: gradientShift 20s ease infinite;
        }

        body.theme-forest {
            background: linear-gradient(-45deg, #1b4332, #2d5016, #52b788, #74c69d, #95d5b2, #b7e4c7);
            background-size: 400% 400%;
            animation: gradientShift 20s ease infinite;
        }

        body.theme-sunset {
            background: linear-gradient(180deg, #ff6b35 0%, #f7931e 25%, #ffd700 50%, #ffb347 75%, #d2691e 100%);
            background-size: 100% 400%;
            animation: sunsetShift 25s ease infinite;
        }

        body.theme-midnight {
            background: linear-gradient(-45deg, #0b0c10, #1f2833, #66fcf1, #45a29e, #c5c6c7, #8892b0);
            background-size: 400% 400%;
            animation: gradientShift 20s ease infinite;
        }

        /* Enhanced starfield background - Theme specific */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                /* Varied star sizes and colors */
                radial-gradient(2px 2px at 20px 30px, #fff, transparent),
                radial-gradient(3px 3px at 40px 70px, rgba(255,255,255,0.8), transparent),
                radial-gradient(1px 1px at 90px 40px, #4ecdc4, transparent),
                radial-gradient(1.5px 1.5px at 130px 80px, rgba(255,107,107,0.6), transparent),
                radial-gradient(2px 2px at 160px 30px, #ffd700, transparent),
                radial-gradient(1px 1px at 200px 120px, rgba(138,43,226,0.8), transparent),
                radial-gradient(2.5px 2.5px at 60px 150px, rgba(255,255,255,0.9), transparent),
                /* Nebula-like clouds */
                radial-gradient(ellipse 150px 80px at 30% 70%, rgba(138,43,226,0.1), transparent),
                radial-gradient(ellipse 120px 60px at 80% 30%, rgba(255,107,107,0.08), transparent);
            background-repeat: repeat;
            background-size: 250px 180px;
            animation: cosmicDance 4s linear infinite;
            pointer-events: none;
            z-index: 1;
        }

        body.theme-ocean::before {
            background-image: 
                radial-gradient(3px 3px at 15px 25px, rgba(144,224,239,0.8), transparent),
                radial-gradient(2px 2px at 35px 65px, rgba(0,180,216,0.6), transparent),
                radial-gradient(4px 4px at 85px 35px, rgba(144,224,239,0.9), transparent),
                radial-gradient(1px 1px at 125px 75px, rgba(0,180,216,0.7), transparent),
                radial-gradient(2px 2px at 155px 25px, rgba(144,224,239,0.8), transparent);
            animation: bubbleFloat 4s ease-in-out infinite;
        }

        body.theme-forest::before {
            /* Tree silhouettes and falling leaves */
            background: 
                /* Tree trunks */
                linear-gradient(0deg, 
                    rgba(101,67,33,0.8) 80%, 
                    rgba(101,67,33,0.6) 85%, 
                    transparent 90%
                ) 5% 100% / 15px 100% no-repeat,
                linear-gradient(0deg, 
                    rgba(101,67,33,0.8) 75%, 
                    rgba(101,67,33,0.4) 82%, 
                    transparent 88%
                ) 15% 100% / 18px 100% no-repeat,
                linear-gradient(0deg, 
                    rgba(101,67,33,0.8) 85%, 
                    rgba(101,67,33,0.5) 90%, 
                    transparent 95%
                ) 85% 100% / 12px 100% no-repeat,
                linear-gradient(0deg, 
                    rgba(101,67,33,0.8) 78%, 
                    rgba(101,67,33,0.4) 85%, 
                    transparent 92%
                ) 95% 100% / 16px 100% no-repeat,
                /* Tree canopies */
                radial-gradient(ellipse 120px 80px at 8% 75%, rgba(82,183,136,0.6), rgba(82,183,136,0.3) 60%, transparent 70%),
                radial-gradient(ellipse 140px 90px at 18% 70%, rgba(116,198,157,0.5), rgba(116,198,157,0.2) 65%, transparent 75%),
                radial-gradient(ellipse 100px 70px at 88% 80%, rgba(149,213,178,0.7), rgba(149,213,178,0.3) 55%, transparent 65%),
                radial-gradient(ellipse 110px 85px at 98% 75%, rgba(183,228,199,0.5), rgba(183,228,199,0.2) 60%, transparent 70%),
                /* Falling leaves */
                radial-gradient(3px 6px at 25% 10%, rgba(255,193,7,0.8), transparent),
                radial-gradient(4px 7px at 45% 20%, rgba(255,152,0,0.7), transparent),
                radial-gradient(2px 4px at 65% 5%, rgba(183,228,199,0.9), transparent),
                radial-gradient(3px 5px at 85% 15%, rgba(255,87,34,0.8), transparent),
                radial-gradient(2px 5px at 15% 30%, rgba(76,175,80,0.7), transparent);
            animation: forestLife 6s ease-in-out infinite;
        }

        body.theme-sunset::before {
            background: 
                /* Sun with proper rays */
                radial-gradient(circle 60px at 85% 25%, 
                    rgba(255,255,0,0.9) 20%, 
                    rgba(255,193,7,0.8) 40%, 
                    rgba(255,152,0,0.6) 60%, 
                    transparent 80%
                ),
                /* Sun rays radiating outward */
                conic-gradient(from 0deg at 85% 25%, 
                    transparent 0deg, 
                    rgba(255,223,0,0.3) 10deg, 
                    transparent 20deg,
                    rgba(255,193,7,0.2) 30deg, 
                    transparent 40deg,
                    rgba(255,152,0,0.3) 50deg, 
                    transparent 60deg,
                    rgba(255,223,0,0.2) 70deg, 
                    transparent 80deg,
                    rgba(255,193,7,0.3) 90deg, 
                    transparent 100deg,
                    rgba(255,152,0,0.2) 110deg, 
                    transparent 120deg,
                    rgba(255,223,0,0.3) 130deg, 
                    transparent 140deg,
                    rgba(255,193,7,0.2) 150deg, 
                    transparent 160deg,
                    rgba(255,152,0,0.3) 170deg, 
                    transparent 180deg,
                    rgba(255,223,0,0.2) 190deg, 
                    transparent 200deg,
                    rgba(255,193,7,0.3) 210deg, 
                    transparent 220deg,
                    rgba(255,152,0,0.2) 230deg, 
                    transparent 240deg,
                    rgba(255,223,0,0.3) 250deg, 
                    transparent 260deg,
                    rgba(255,193,7,0.2) 270deg, 
                    transparent 280deg,
                    rgba(255,152,0,0.3) 290deg, 
                    transparent 300deg,
                    rgba(255,223,0,0.2) 310deg, 
                    transparent 320deg,
                    rgba(255,193,7,0.3) 330deg, 
                    transparent 340deg,
                    rgba(255,152,0,0.2) 350deg, 
                    transparent 360deg
                ),
                /* Beach horizon */
                linear-gradient(180deg, 
                    transparent 70%, 
                    rgba(255,248,220,0.1) 75%, 
                    rgba(255,228,181,0.15) 80%, 
                    rgba(244,164,96,0.2) 90%, 
                    rgba(205,133,63,0.25) 100%
                );
            animation: sunsetScene 20s ease-in-out infinite;
        }

        body.theme-midnight::before {
            background: 
                /* Moon */
                radial-gradient(circle 45px at 80% 20%, 
                    rgba(245,245,245,0.9) 35%, 
                    rgba(220,220,220,0.7) 50%, 
                    rgba(192,192,192,0.4) 70%, 
                    transparent 85%
                ),
                /* Moon craters */
                radial-gradient(circle 8px at 75% 18%, rgba(169,169,169,0.6), transparent 60%),
                radial-gradient(circle 5px at 83% 22%, rgba(169,169,169,0.4), transparent 50%),
                radial-gradient(circle 6px at 78% 24%, rgba(169,169,169,0.5), transparent 55%),
                /* Stars constellation pattern */
                radial-gradient(2px 2px at 16px 26px, rgba(245,245,245,0.9), transparent),
                radial-gradient(1px 1px at 44px 66px, rgba(173,216,230,0.8), transparent),
                radial-gradient(3px 3px at 86px 36px, rgba(255,255,255,0.9), transparent),
                radial-gradient(1.5px 1.5px at 126px 76px, rgba(230,230,250,0.7), transparent),
                radial-gradient(1px 1px at 156px 26px, rgba(176,196,222,0.8), transparent),
                radial-gradient(2px 2px at 200px 100px, rgba(255,255,255,0.9), transparent),
                radial-gradient(1px 1px at 50px 140px, rgba(173,216,230,0.7), transparent),
                /* Night clouds */
                radial-gradient(ellipse 200px 60px at 25% 80%, rgba(25,25,112,0.3), transparent 70%),
                radial-gradient(ellipse 150px 40px at 75% 85%, rgba(25,25,112,0.2), transparent 60%);
            background-repeat: repeat;
            background-size: 300px 200px;
            animation: midnightSky 8s ease-in-out infinite;
        }

        /* Floating geometric shapes - Theme specific */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 15% 25%, rgba(255, 107, 107, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 85% 75%, rgba(72, 187, 120, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 60% 40%, rgba(66, 153, 225, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 30% 80%, rgba(236, 201, 75, 0.1) 0%, transparent 50%);
            animation: float 8s ease-in-out infinite;
            pointer-events: none;
            z-index: 1;
        }

        body.theme-ocean::after {
            background: 
                radial-gradient(ellipse at 20% 30%, rgba(0,180,216,0.15) 0%, transparent 60%),
                radial-gradient(ellipse at 80% 70%, rgba(144,224,239,0.15) 0%, transparent 60%),
                radial-gradient(ellipse at 50% 50%, rgba(42,111,151,0.1) 0%, transparent 70%),
                radial-gradient(ellipse at 25% 75%, rgba(0,119,190,0.12) 0%, transparent 65%);
            animation: waveMotion 10s ease-in-out infinite;
        }

        body.theme-forest::after {
            background: 
                radial-gradient(ellipse at 10% 20%, rgba(82,183,136,0.15) 0%, transparent 55%),
                radial-gradient(ellipse at 90% 80%, rgba(116,198,157,0.15) 0%, transparent 65%),
                radial-gradient(ellipse at 65% 35%, rgba(27,67,50,0.1) 0%, transparent 70%),
                radial-gradient(ellipse at 35% 85%, rgba(149,213,178,0.12) 0%, transparent 60%);
            animation: windSway 12s ease-in-out infinite;
        }

        body.theme-sunset::after {
            background: 
                /* Beach sand texture */
                linear-gradient(180deg, transparent 70%, rgba(194,154,108,0.1) 75%, rgba(238,203,173,0.15) 85%, rgba(205,133,63,0.1) 100%),
                /* Palm tree silhouettes */
                radial-gradient(ellipse 40px 120px at 10% 75%, rgba(0,0,0,0.3) 40%, transparent 50%),
                radial-gradient(ellipse 35px 100px at 90% 80%, rgba(0,0,0,0.25) 40%, transparent 50%),
                /* Sun reflection on water */
                linear-gradient(90deg, transparent 0%, rgba(255,215,0,0.1) 45%, rgba(255,140,0,0.2) 50%, rgba(255,215,0,0.1) 55%, transparent 100%);
            animation: beachScene 12s ease-in-out infinite;
        }

        body.theme-midnight::after {
            background: 
                radial-gradient(ellipse at 30% 25%, rgba(102,252,241,0.15) 0%, transparent 50%),
                radial-gradient(ellipse at 70% 75%, rgba(69,162,158,0.15) 0%, transparent 55%),
                radial-gradient(ellipse at 45% 55%, rgba(11,12,16,0.2) 0%, transparent 65%),
                radial-gradient(ellipse at 15% 85%, rgba(136,146,176,0.12) 0%, transparent 60%);
            animation: cyberpulse 7s ease-in-out infinite;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes sunsetShift {
            0% { background-position: 0% 0%; }
            50% { background-position: 0% 100%; }
            100% { background-position: 0% 0%; }
        }

        @keyframes cosmicDance {
            0% { 
                opacity: 0.6; 
                transform: translateX(0) rotate(0deg); 
                filter: hue-rotate(0deg);
            }
            25% { 
                opacity: 0.8; 
                transform: translateX(-50px) rotate(90deg); 
                filter: hue-rotate(90deg);
            }
            50% { 
                opacity: 1; 
                transform: translateX(-100px) rotate(180deg); 
                filter: hue-rotate(180deg);
            }
            75% { 
                opacity: 0.8; 
                transform: translateX(-150px) rotate(270deg); 
                filter: hue-rotate(270deg);
            }
            100% { 
                opacity: 0.6; 
                transform: translateX(-200px) rotate(360deg); 
                filter: hue-rotate(360deg);
            }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) scale(1); }
            50% { transform: translateY(-20px) scale(1.05); }
        }

        /* Theme-specific animations */
        @keyframes bubbleFloat {
            0%, 100% { opacity: 0.4; transform: translateY(0); }
            50% { opacity: 0.8; transform: translateY(-15px); }
        }

        @keyframes forestLife {
            0%, 100% { 
                transform: translateY(0px) rotate(0deg); 
                filter: brightness(1);
            }
            25% { 
                transform: translateY(-8px) rotate(2deg); 
                filter: brightness(1.1);
            }
            50% { 
                transform: translateY(-15px) rotate(0deg); 
                filter: brightness(1.2);
            }
            75% { 
                transform: translateY(-5px) rotate(-1deg); 
                filter: brightness(1.1);
            }
        }

        @keyframes sunsetScene {
            0%, 100% { 
                filter: hue-rotate(0deg) brightness(1) saturate(1);
                transform: translateY(0px);
            }
            25% { 
                filter: hue-rotate(5deg) brightness(1.1) saturate(1.2);
                transform: translateY(-2px);
            }
            50% { 
                filter: hue-rotate(10deg) brightness(1.2) saturate(1.4);
                transform: translateY(-5px);
            }
            75% { 
                filter: hue-rotate(15deg) brightness(1.15) saturate(1.3);
                transform: translateY(-3px);
            }
        }

        @keyframes midnightSky {
            0%, 100% { 
                opacity: 0.8; 
                transform: translateY(0px) scale(1);
                filter: brightness(1);
            }
            25% { 
                opacity: 0.9; 
                transform: translateY(-3px) scale(1.02);
                filter: brightness(1.1);
            }
            50% { 
                opacity: 1; 
                transform: translateY(-5px) scale(1.05);
                filter: brightness(1.2);
            }
            75% { 
                opacity: 0.95; 
                transform: translateY(-2px) scale(1.03);
                filter: brightness(1.1);
            }
        }

        @keyframes beachScene {
            0%, 100% { 
                opacity: 0.8; 
                transform: translateX(0px) scaleY(1);
            }
            50% { 
                opacity: 1; 
                transform: translateX(5px) scaleY(1.02);
            }
        }

        @keyframes neonPulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        @keyframes waveMotion {
            0%, 100% { transform: translateY(0px) scaleX(1); }
            50% { transform: translateY(-10px) scaleX(1.1); }
        }

        @keyframes windSway {
            0%, 100% { transform: translateX(0px) scaleY(1); }
            33% { transform: translateX(8px) scaleY(0.95); }
            66% { transform: translateX(-5px) scaleY(1.05); }
        }

        @keyframes heatShimmer {
            0%, 100% { transform: translateY(0px) scale(1); opacity: 0.4; }
            50% { transform: translateY(-8px) scale(1.05); opacity: 0.8; }
        }

        @keyframes cyberpulse {
            0%, 100% { transform: scale(1) rotate(0deg); opacity: 0.5; }
            50% { transform: scale(1.08) rotate(2deg); opacity: 0.9; }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 2;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: #fff;
        }

        .header h1 {
            font-size: 3.5rem;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(138, 43, 226, 0.8), 0 0 40px rgba(138, 43, 226, 0.4);
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 900;
            letter-spacing: 3px;
            animation: gradientText 4s ease infinite, glow 2s ease-in-out infinite alternate;
        }

        @keyframes gradientText {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        @keyframes glow {
            from { filter: drop-shadow(0 0 10px rgba(138, 43, 226, 0.5)); }
            to { filter: drop-shadow(0 0 20px rgba(138, 43, 226, 0.8)); }
        }

        .subtitle {
            font-size: 1.4rem;
            opacity: 0.9;
            margin-bottom: 20px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.7);
            background: linear-gradient(45deg, #ffd700, #ff8c00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 600;
        }

        /* Menu Button */
        .menu-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid rgba(138, 43, 226, 0.5);
            color: #fff;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            backdrop-filter: blur(20px);
            transition: all 0.3s ease;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1001;
            box-shadow: 0 8px 20px rgba(138, 43, 226, 0.3);
        }

        .menu-button:hover {
            background: rgba(138, 43, 226, 0.3);
            transform: scale(1.1);
            box-shadow: 0 10px 25px rgba(138, 43, 226, 0.5);
        }

        /* Settings Menu Overlay */
        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        .menu-overlay.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .settings-menu {
            background: rgba(0, 0, 0, 0.95);
            border: 2px solid rgba(138, 43, 226, 0.5);
            border-radius: 25px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 40px rgba(138, 43, 226, 0.3);
            animation: slideUp 0.3s ease;
            max-height: 90vh;
            overflow-y: auto;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .menu-title {
            font-size: 2rem;
            text-align: center;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: bold;
        }

        .menu-section {
            margin-bottom: 25px;
        }

        .menu-section h3 {
            color: #4ecdc4;
            font-size: 1.2rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-switch.active {
            background: linear-gradient(135deg, #4ecdc4, #45b7d1);
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s ease;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        .toggle-switch.active::after {
            transform: translateX(26px);
            box-shadow: 0 2px 8px rgba(78, 205, 196, 0.4);
        }

        /* Volume slider styling */
        .volume-slider {
            width: 120px;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            outline: none;
            cursor: pointer;
            -webkit-appearance: none;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: linear-gradient(135deg, #4ecdc4, #45b7d1);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(78, 205, 196, 0.4);
            transition: all 0.3s ease;
        }

        .volume-slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 4px 12px rgba(78, 205, 196, 0.6);
        }

        .volume-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: linear-gradient(135deg, #4ecdc4, #45b7d1);
            border-radius: 50%;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 6px rgba(78, 205, 196, 0.4);
        }

        /* Enhanced dropdown styling */
        .dropdown-select {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.6), rgba(138, 43, 226, 0.1));
            border: 2px solid rgba(138, 43, 226, 0.4);
            color: white;
            padding: 10px 15px;
            border-radius: 15px;
            cursor: pointer;
            min-width: 140px;
            font-weight: 500;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .dropdown-select:hover {
            border-color: rgba(138, 43, 226, 0.7);
            background: linear-gradient(135deg, rgba(138, 43, 226, 0.2), rgba(0, 0, 0, 0.8));
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(138, 43, 226, 0.3);
        }

        .dropdown-select:focus {
            outline: none;
            border-color: #4ecdc4;
            box-shadow: 0 0 20px rgba(78, 205, 196, 0.4);
        }

        .dropdown-select option {
            background: #1a1a2e;
            color: white;
        }

        .close-menu-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            color: #fff;
            font-size: 24px;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-menu-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.1);
        }

        .game-layout {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 30px;
            margin-bottom: 20px;
        }

        .left-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .map-container {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 25px;
            padding: 25px;
            box-shadow: 0 15px 35px rgba(138, 43, 226, 0.3), inset 0 1px 0 rgba(255,255,255,0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(138, 43, 226, 0.3);
            height: 500px;
            position: relative;
            overflow: hidden;
        }

        .map-title {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.3rem;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        #worldMap {
            width: 100%;
            height: calc(100% - 40px);
            border-radius: 15px;
            border: 2px solid rgba(138, 43, 226, 0.4);
            filter: hue-rotate(20deg) saturate(1.2);
        }

        .challenge-info {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 25px;
            padding: 25px;
            box-shadow: 0 15px 35px rgba(72, 187, 120, 0.3), inset 0 1px 0 rgba(255,255,255,0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(72, 187, 120, 0.3);
        }

        .challenge-title {
            font-size: 1.6rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
            color: #4ecdc4;
            text-shadow: 0 0 15px rgba(78, 205, 196, 0.6);
        }

        .country-pair {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            font-size: 1.3rem;
            font-weight: bold;
        }

        .country-flag {
            padding: 15px 25px;
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            border-radius: 20px;
            text-align: center;
            min-width: 150px;
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
            transform: perspective(1000px) rotateY(-5deg);
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .country-flag:hover {
            transform: perspective(1000px) rotateY(0deg) translateY(-5px);
            box-shadow: 0 12px 35px rgba(255, 107, 107, 0.6);
        }

        .arrow {
            font-size: 2rem;
            color: #ffd700;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .right-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .game-info {
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 25px;
            color: white;
            text-align: center;
            border: 1px solid rgba(66, 153, 225, 0.3);
            box-shadow: 0 15px 35px rgba(66, 153, 225, 0.3), inset 0 1px 0 rgba(255,255,255,0.1);
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }

        .stat {
            text-align: center;
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 15px;
            min-width: 80px;
            border: 1px solid rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            background: linear-gradient(45deg, #4ecdc4, #45b7d1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .input-section {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(236, 201, 75, 0.3), inset 0 1px 0 rgba(255,255,255,0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(236, 201, 75, 0.3);
        }

        .search-container {
            position: relative;
            margin-bottom: 20px;
        }

        .search-input {
            width: 100%;
            padding: 18px;
            font-size: 1.1rem;
            border: 2px solid rgba(78, 205, 196, 0.4);
            border-radius: 20px;
            outline: none;
            transition: all 0.3s ease;
            background: rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            color: #fff;
        }

        .search-input::placeholder {
            color: rgba(255,255,255,0.7);
        }

        .search-input:focus {
            border-color: #4ecdc4;
            box-shadow: 0 0 20px rgba(78, 205, 196, 0.4);
            transform: translateY(-2px);
        }

        .suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(78, 205, 196, 0.3);
            border-top: none;
            border-radius: 0 0 20px 20px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
        }

        .suggestion-item {
            padding: 12px 18px;
            cursor: pointer;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            transition: all 0.2s;
            color: #fff;
        }

        .suggestion-item:hover {
            background: rgba(78, 205, 196, 0.2);
            transform: translateX(5px);
        }

        .action-btn {
            width: 100%;
            padding: 18px;
            font-size: 1.2rem;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 8px 20px rgba(255, 107, 107, 0.4);
            margin-bottom: 10px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .action-btn:hover:not(:disabled) {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 12px 30px rgba(255, 107, 107, 0.6);
        }

        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .path-container {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(138, 43, 226, 0.3), inset 0 1px 0 rgba(255,255,255,0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(138, 43, 226, 0.3);
            grid-column: 1 / -1;
        }

        .path-title {
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
            color: #ffd700;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.6);
        }

        .path-visual {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }

        .path-country {
            padding: 12px 20px;
            background: linear-gradient(135deg, #4ecdc4, #45b7d1);
            color: white;
            border-radius: 20px;
            font-weight: 600;
            text-align: center;
            min-width: 120px;
            box-shadow: 0 6px 20px rgba(78, 205, 196, 0.4);
            animation: slideIn 0.5s ease-out;
            border: 1px solid rgba(255,255,255,0.2);
            transform: perspective(1000px) rotateX(5deg);
        }

        .path-arrow {
            font-size: 1.5rem;
            color: #ffd700;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
        }

        .game-over {
            text-align: center;
            padding: 40px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 25px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.1);
            margin-top: 20px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            grid-column: 1 / -1;
        }

        .game-over h2 {
            margin-bottom: 20px;
            font-size: 2.5rem;
        }

        .win {
            color: #4ecdc4;
            text-shadow: 0 0 20px rgba(78, 205, 196, 0.8);
            animation: winPulse 1s ease-in-out infinite alternate;
        }

        .lose {
            color: #ff6b6b;
            text-shadow: 0 0 20px rgba(255, 107, 107, 0.8);
        }

        @keyframes winPulse {
            from { transform: scale(1); }
            to { transform: scale(1.05); }
        }

        .new-game-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            border: none;
            padding: 18px 35px;
            border-radius: 20px;
            font-size: 1.2rem;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 8px 20px rgba(255, 107, 107, 0.4);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .new-game-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 12px 30px rgba(255, 107, 107, 0.6);
        }

        .optimal-path {
            background: linear-gradient(135deg, rgba(78, 205, 196, 0.1), rgba(69, 183, 209, 0.1));
            border-radius: 20px;
            padding: 20px;
            margin-top: 20px;
            border-left: 5px solid #4ecdc4;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(78, 205, 196, 0.3);
        }

        .score-display {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 15px 0;
            color: #fff;
        }

        /* Winning effect particles */
        .particle {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #ffd700;
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
        }

        /* Game mode navigation styling */
        .game-button {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24, #ff6b6b);
            background-size: 200% 200%;
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            padding: 18px 35px;
            margin: 12px;
            font-size: 18px;
            font-weight: 600;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.4s ease;
            backdrop-filter: blur(15px);
            box-shadow: 0 10px 25px rgba(255, 107, 107, 0.4);
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .game-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: all 0.6s ease;
        }

        .game-button:hover::before {
            left: 100%;
        }

        .game-button:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 15px 35px rgba(255, 107, 107, 0.6);
            background-position: 100% 0;
            border-color: rgba(255,255,255,0.5);
        }

        .game-button:active {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 20px rgba(255, 107, 107, 0.5);
        }

        /* Enhanced Feedback Button */
        .feedback-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 15px 25px;
            border-radius: 30px;
            font-family: 'Segoe UI', sans-serif;
            font-size: 14px;
            font-weight: 600;
            text-decoration: none;
            box-shadow: 0 10px 25px rgba(255, 107, 107, 0.4);
            z-index: 1000;
            border: 2px solid rgba(255,255,255,0.2);
            backdrop-filter: blur(15px);
            transition: all 0.4s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .feedback-button:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 15px 35px rgba(255, 107, 107, 0.6);
            background: linear-gradient(135deg, #ee5a24, #ff6b6b);
            text-decoration: none;
            color: white;
        }

        .feedback-button::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #ff6b6b);
            border-radius: 32px;
            z-index: -1;
            filter: blur(8px);
            opacity: 0.7;
            animation: borderGlow 3s ease infinite;
        }

        @keyframes borderGlow {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 0.9; }
        }

        .feedback-icon {
            font-size: 16px;
            animation: bounce 2s ease infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-3px); }
            60% { transform: translateY(-2px); }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(0.9) perspective(1000px) rotateX(-10deg);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1) perspective(1000px) rotateX(5deg);
            }
        }

        @media (max-width: 1024px) {
            .game-layout {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .map-container {
                height: 400px;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
            
            .country-pair {
                flex-direction: column;
                gap: 10px;
            }
            
            .path-visual {
                flex-direction: column;
            }
            
            .path-arrow {
                transform: rotate(90deg);
            }

            .menu-button {
                top: 10px;
                left: 10px;
            }
            
            .settings-menu {
                padding: 25px;
                width: 95%;
            }
            
            .feedback-button {
                bottom: 15px;
                right: 15px;
                padding: 12px 20px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <!-- Menu Button -->
    <button class="menu-button" id="menuButton">⚙️</button>

    <!-- Settings Menu Overlay -->
    <div class="menu-overlay" id="menuOverlay">
        <div class="settings-menu">
            <button class="close-menu-btn" id="closeMenuBtn">×</button>
            <h2 class="menu-title">⚙️ Game Settings</h2>
            
            <div class="menu-section">
                <h3>🔊 Audio Settings</h3>
                <div class="setting-item">
                    <span>Background Music</span>
                    <div class="toggle-switch" id="musicToggle"></div>
                </div>
                <div class="setting-item">
                    <span>Sound Effects</span>
                    <div class="toggle-switch active" id="sfxToggle"></div>
                </div>
                <div class="setting-item">
                    <span>Master Volume</span>
                    <input type="range" min="0" max="100" value="70" class="volume-slider" id="volumeSlider">
                </div>
            </div>

            <div class="menu-section">
                <h3>🌍 Language & Region</h3>
                <div class="setting-item">
                    <span>Language</span>
                    <select class="dropdown-select" id="languageSelect">
                        <option value="en">🇺🇸 English</option>
                        <option value="es">🇪🇸 Español</option>
                        <option value="fr">🇫🇷 Français</option>
                        <option value="de">🇩🇪 Deutsch</option>
                        <option value="it">🇮🇹 Italiano</option>
                        <option value="pt">🇧🇷 Português</option>
                        <option value="ru">🇷🇺 Русский</option>
                        <option value="zh">🇨🇳 中文</option>
                        <option value="ja">🇯🇵 日本語</option>
                        <option value="ko">🇰🇷 한국어</option>
                    </select>
                </div>
                <div class="setting-item">
                    <span>Country Display</span>
                    <select class="dropdown-select" id="countryDisplaySelect">
                        <option value="name">Country Names</option>
                        <option value="flag">Flags Only</option>
                        <option value="both">Names + Flags</option>
                    </select>
                </div>
            </div>

            <div class="menu-section">
                <h3>🎮 Game Settings</h3>
                <div class="setting-item">
                    <span>Difficulty Mode</span>
                    <select class="dropdown-select" id="difficultySelect">
                        <option value="easy">🟢 Easy (+8 attempts)</option>
                        <option value="normal" selected>🟡 Normal (+5 attempts)</option>
                        <option value="hard">🔴 Hard (+3 attempts)</option>
                        <option value="expert">⚫ Expert (+1 attempt)</option>
                    </select>
                </div>
                <div class="setting-item">
                    <span>Hint System</span>
                    <div class="toggle-switch active" id="hintsToggle"></div>
                </div>
                <div class="setting-item">
                    <span>Auto-Save Progress</span>
                    <div class="toggle-switch active" id="autoSaveToggle"></div>
                </div>
            </div>

            <div class="menu-section">
                <h3>🎨 Visual Settings</h3>
                <div class="setting-item">
                    <span>Theme</span>
                    <select class="dropdown-select" id="themeSelect">
                        <option value="cosmic">🌌 Cosmic (Default)</option>
                        <option value="ocean">🌊 Ocean Blue</option>
                        <option value="forest">🌲 Forest Green</option>
                        <option value="sunset">🌅 Sunset Orange</option>
                        <option value="midnight">🌙 Midnight Purple</option>
                    </select>
                </div>
                <div class="setting-item">
                    <span>Animations</span>
                    <div class="toggle-switch active" id="animationsToggle"></div>
                </div>
                <div class="setting-item">
                    <span>Particle Effects</span>
                    <div class="toggle-switch active" id="particlesToggle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden audio elements -->
    <audio id="backgroundMusic" loop>
        <source src="https://www.soundjay.com/misc/sounds-909.wav" type="audio/wav">
    </audio>
    <audio id="winSound">
        <source src="https://www.soundjay.com/misc/sounds-907.wav" type="audio/wav">
    </audio>
    <audio id="clickSound">
        <source src="https://www.soundjay.com/misc/sounds-901.wav" type="audio/wav">
    </audio>

    <div class="container">
        <div class="header">
            <h1>Routele 🗺️</h1>
            <div class="subtitle">Navigate the world through land and sea borders!</div>
        </div>

        <!-- Button Container -->
        <div style="text-align:center; margin: 40px;">
          <button onclick="goToCountryMode()" class="game-button">🌍 Countryle</button>
          <button onclick="goToClassicMode()" class="game-button">🎯 Geodle</button>
          <button onclick="goToFlagMode()" class="game-button">🚩 Flagle</button>
        </div>

        <div class="game-layout">
            <div class="left-section">
                <div class="map-container">
                    <div class="map-title">🌟 Interactive World Map</div>
                    <div id="worldMap"></div>
                </div>

                <div class="challenge-info">
                    <div class="challenge-title">Today's Path Challenge</div>
                    <div class="country-pair">
                        <div class="country-flag" id="startCountry">Loading...</div>
                        <div class="arrow">→</div>
                        <div class="country-flag" id="endCountry">Loading...</div>
                    </div>
                    <div style="text-align: center; margin-top: 15px; color: #4ecdc4;">
                        Create the shortest path by connecting neighboring countries!
                    </div>
                </div>
            </div>

            <div class="right-section">
                <div class="game-info">
                    <div class="stats">
                        <div class="stat">
                            <div class="stat-number" id="pathLength">0</div>
                            <div>Path Length</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number" id="optimalLength">...</div>
                            <div>Optimal</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number" id="attempts">...</div>
                            <div>Attempts</div>
                        </div>
                    </div>
                </div>

                <div class="input-section">
                    <div class="search-container">
                        <input type="text" id="countryInput" class="search-input" 
                               placeholder="🌍 Enter next country in your path..." autocomplete="off">
                        <div id="suggestions" class="suggestions"></div>
                    </div>
                    <button id="addCountryBtn" class="action-btn">⚡ Add to Path</button>
                    <button id="finishPathBtn" class="action-btn" style="background: linear-gradient(135deg, #4ecdc4, #45b7d1);" disabled>
                        🎯 Complete Journey
                    </button>
                    <button id="resetPathBtn" class="action-btn" style="background: linear-gradient(135deg, #ff6b6b, #ee5a24);">
                        🔄 Restart Path
                    </button>
                </div>
            </div>
        </div>

        <div class="path-container">
            <div class="path-title">Your Journey Trail</div>
            <div class="path-visual" id="pathVisual">
                <div class="path-country" id="startInPath">Start here...</div>
            </div>
        </div>

        <div id="gameOver" class="game-over" style="display: none;">
            <h2 id="gameOverTitle"></h2>
            <div class="score-display" id="scoreDisplay"></div>
            <div class="optimal-path" id="optimalPathInfo"></div>
            <button id="newGameBtn" class="new-game-btn">🎮 Try Again</button>
        </div>
    </div>

    <!-- Enhanced Feedback Button -->
    <a href="https://docs.google.com/forms/d/e/1FAIpQLSf66hYSFxnaQXvXmHlWU2MIGwIn3dkmiQ5iguGazXRKw4cSEg/viewform?usp=sharing&ouid=111077547070042896084" 
       target="_blank" 
       class="feedback-button">
       <span class="feedback-icon">✨</span>
       <span>Help Us Improve</span>
    </a>

    <script>
        // Audio variables
        let musicEnabled = false;
        let sfxEnabled = true;
        let backgroundMusic, winSound, clickSound;

        // Game state
        let startCountry = '';
        let endCountry = '';
        let currentPath = [];
        let gameCompleted = false;
        let attempts = 10;
        let maxAttempts = 10;
        let optimalPath = [];
        let map = null;
        let pathMarkers = [];
        let countryNames = [];

        // Cache for optimal paths to avoid recalculating
        let pathCache = new Map();

        // Initialize audio
        function initAudio() {
            backgroundMusic = document.getElementById('backgroundMusic');
            winSound = document.getElementById('winSound');
            clickSound = document.getElementById('clickSound');

            // Create simple tones using Web Audio API as fallback
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            
            // Background music simulation - Light and cheerful melody
            function playBackgroundTone() {
                if (!musicEnabled) return;
                
                // Create a pleasant major scale melody
                const notes = [523.25, 587.33, 659.25, 698.46, 783.99, 880.00, 987.77]; // C5 to B5
                const melody = [0, 2, 4, 2, 0, 4, 2, 0]; // Simple pleasant melody pattern
                
                melody.forEach((noteIndex, i) => {
                    setTimeout(() => {
                        const oscillator = audioContext.createOscillator();
                        const gainNode = audioContext.createGain();
                        
                        oscillator.connect(gainNode);
                        gainNode.connect(audioContext.destination);
                        
                        // Use a softer waveform
                        oscillator.type = 'sine';
                        oscillator.frequency.setValueAtTime(notes[noteIndex], audioContext.currentTime);
                        
                        // Gentle envelope
                        gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                        gainNode.gain.linearRampToValueAtTime(0.02, audioContext.currentTime + 0.1);
                        gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.8);
                        
                        oscillator.start();
                        oscillator.stop(audioContext.currentTime + 0.8);
                    }, i * 600);
                });
                
                // Schedule next melody loop
                setTimeout(playBackgroundTone, 8000);
            }

            // Win sound
            window.playWinSound = function() {
                if (!sfxEnabled) return;
                
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(523, audioContext.currentTime);
                oscillator.frequency.setValueAtTime(659, audioContext.currentTime + 0.1);
                oscillator.frequency.setValueAtTime(784, audioContext.currentTime + 0.2);
                
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.5);
            };

            // Click sound
            window.playClickSound = function() {
                if (!sfxEnabled) return;
                
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.1);
            };
        }

        // Particle effect for winning
        function createWinningEffect() {
            const colors = ['#ffd700', '#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4'];
            
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.left = Math.random() * window.innerWidth + 'px';
                    particle.style.top = '-10px';
                    particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                    particle.style.width = (Math.random() * 8 + 4) + 'px';
                    particle.style.height = particle.style.width;
                    
                    document.body.appendChild(particle);
                    
                    const animation = particle.animate([
                        { 
                            transform: 'translateY(0px) rotate(0deg)',
                            opacity: 1
                        },
                        { 
                            transform: `translateY(${window.innerHeight + 20}px) rotate(${Math.random() * 360}deg)`,
                            opacity: 0
                        }
                    ], {
                        duration: Math.random() * 3000 + 2000,
                        easing: 'ease-out'
                    });
                    
                    animation.onfinish = () => {
                        particle.remove();
                    };
                }, i * 100);
            }
        }

        // Initialize the game when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initAudio();
            initSettingsMenu();
            
            // Extract country names from the imported data
            if (typeof countries !== 'undefined') {
                countryNames = countries.map(country => country.name);
                initializeGame();
            } else {
                console.error('Countries data not loaded. Make sure country-data.js is included.');
            }
        });

        // Settings menu functionality
        function initSettingsMenu() {
            const menuButton = document.getElementById('menuButton');
            const menuOverlay = document.getElementById('menuOverlay');
            const closeMenuBtn = document.getElementById('closeMenuBtn');
            const musicToggle = document.getElementById('musicToggle');
            const sfxToggle = document.getElementById('sfxToggle');
            const volumeSlider = document.getElementById('volumeSlider');
            const languageSelect = document.getElementById('languageSelect');
            const difficultySelect = document.getElementById('difficultySelect');
            const themeSelect = document.getElementById('themeSelect');

            // Menu open/close
            menuButton.addEventListener('click', function() {
                window.playClickSound && window.playClickSound();
                menuOverlay.classList.add('active');
            });

            closeMenuBtn.addEventListener('click', function() {
                window.playClickSound && window.playClickSound();
                menuOverlay.classList.remove('active');
            });

            menuOverlay.addEventListener('click', function(e) {
                if (e.target === menuOverlay) {
                    menuOverlay.classList.remove('active');
                }
            });

            // Audio toggles
            musicToggle.addEventListener('click', function() {
                window.playClickSound && window.playClickSound();
                musicEnabled = !musicEnabled;
                this.classList.toggle('active', musicEnabled);
                if (musicEnabled) {
                    playBackgroundTone();
                }
            });

            sfxToggle.addEventListener('click', function() {
                sfxEnabled = !sfxEnabled;
                this.classList.toggle('active', sfxEnabled);
                if (sfxEnabled) {
                    window.playClickSound && window.playClickSound();
                }
            });

            // Volume control
            volumeSlider.addEventListener('input', function() {
                const volume = this.value / 100;
                console.log('Volume set to:', volume);
            });

            // Language selection
            languageSelect.addEventListener('change', function() {
                window.playClickSound && window.playClickSound();
                const selectedLanguage = this.value;
                console.log('Language changed to:', selectedLanguage);
                showNotification(`Language changed to ${this.options[this.selectedIndex].text}`);
            });

            // Difficulty selection
            difficultySelect.addEventListener('change', function() {
                window.playClickSound && window.playClickSound();
                const difficulty = this.value;
                console.log('Difficulty changed to:', difficulty);
                updateDifficulty(difficulty);
                showNotification(`Difficulty set to ${this.options[this.selectedIndex].text}`);
            });

            // Theme selection
            themeSelect.addEventListener('change', function() {
                window.playClickSound && window.playClickSound();
                const theme = this.value;
                console.log('Theme changed to:', theme);
                applyTheme(theme);
                showNotification(`Theme changed to ${this.options[this.selectedIndex].text}`);
            });

            // Add toggle functionality to all toggle switches
            document.querySelectorAll('.toggle-switch').forEach(toggle => {
                toggle.addEventListener('click', function() {
                    if (this !== musicToggle && this !== sfxToggle) {
                        window.playClickSound && window.playClickSound();
                        this.classList.toggle('active');
                    }
                });
            });
        }

        // Update difficulty based on selection
        function updateDifficulty(difficulty) {
            const bonusAttempts = {
                'easy': 8,
                'normal': 5,
                'hard': 3,
                'expert': 1
            };
            
            if (optimalPath) {
                const optimalLength = optimalPath.length - 1;
                maxAttempts = Math.max(optimalLength + bonusAttempts[difficulty], 5);
                attempts = maxAttempts;
                document.getElementById('attempts').textContent = attempts;
            }
        }

        // Apply theme with enhanced visual differences
        function applyTheme(theme) {
            const body = document.body;
            
            // Remove all theme classes first
            body.classList.remove('theme-ocean', 'theme-forest', 'theme-sunset', 'theme-midnight');
            
            // Apply the selected theme
            if (theme !== 'cosmic') {
                body.classList.add(`theme-${theme}`);
            }
            
            // Theme-specific element color updates
            const themeColors = {
                'cosmic': {
                    primary: '#8a2be2',
                    secondary: '#4ecdc4',
                    accent: '#ffd700'
                },
                'ocean': {
                    primary: '#0077be',
                    secondary: '#00b4d8',
                    accent: '#90e0ef'
                },
                'forest': {
                    primary: '#2d5016',
                    secondary: '#52b788',
                    accent: '#95d5b2'
                },
                'sunset': {
                    primary: '#d2691e',
                    secondary: '#ff8c00',
                    accent: '#ffd700'
                },
                'midnight': {
                    primary: '#66fcf1',
                    secondary: '#45a29e',
                    accent: '#c5c6c7'
                }
            };
            
            const colors = themeColors[theme] || themeColors['cosmic'];
            
            // Update CSS custom properties if needed
            document.documentElement.style.setProperty('--theme-primary', colors.primary);
            document.documentElement.style.setProperty('--theme-secondary', colors.secondary);
            document.documentElement.style.setProperty('--theme-accent', colors.accent);
        }

        // Show notification
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: rgba(0, 0, 0, 0.9);
                color: white;
                padding: 15px 25px;
                border-radius: 20px;
                border: 1px solid rgba(78, 205, 196, 0.5);
                backdrop-filter: blur(20px);
                z-index: 10000;
                animation: slideInRight 0.3s ease, fadeOut 0.3s ease 2.7s forwards;
                box-shadow: 0 10px 25px rgba(78, 205, 196, 0.3);
            `;
            
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideInRight {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes fadeOut {
                    from { opacity: 1; }
                    to { opacity: 0; transform: translateX(100%); }
                }
            `;
            document.head.appendChild(style);
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
                style.remove();
            }, 3000);
        }

        // Navigation functions
        function goToCountryMode() {
            window.playClickSound && window.playClickSound();
            window.location.href = "https://geodle-game.netlify.app/country-mode";
        }

        function goToClassicMode() {
            window.playClickSound && window.playClickSound();
            window.location.href = "https://geodle-game.netlify.app/index.html";
        }

        function goToFlagMode() {
            window.playClickSound && window.playClickSound();
            window.location.href = "flag-mode.html";
        }

        // Create a mapping function to get country data by name
        function getCountryData(countryName) {
            if (typeof countries === 'undefined') return null;
            return countries.find(country => country.name === countryName);
        }

        // Get country coordinates
        function getCountryCoords(countryName) {
            const country = getCountryData(countryName);
            return country ? [country.latitude, country.longitude] : null;
        }

        // Get neighboring countries
        function getNeighbors(countryName) {
            const country = getCountryData(countryName);
            return country && country.borders ? country.borders : [];
        }

        // FIXED: Daily challenge pairs - ensures minimum 4 steps between countries
        function getDailyChallengeFromData() {
            if (!countryNames.length) return ['France', 'Germany'];
            
            const today = new Date();
            const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / 86400000);
            
            // Pre-calculated pairs that are guaranteed to be at least 4 steps apart
            const validChallengePairs = [
                // Europe to Asia
                ['Portugal', 'China'],
                ['Ireland', 'Japan'],
                ['Norway', 'India'],
                ['Spain', 'Mongolia'],
                ['United Kingdom', 'South Korea'],
                
                // Americas to Africa/Asia
                ['Canada', 'South Africa'],
                ['Mexico', 'Egypt'],
                ['United States', 'Morocco'],
                ['Brazil', 'Kenya'],
                ['Argentina', 'Nigeria'],
                
                // Cross-continental distant pairs
                ['Australia', 'France'],
                ['New Zealand', 'Germany'],
                ['Chile', 'Russia'],
                ['Peru', 'Turkey'],
                ['Colombia', 'Iran'],
                
                // Africa to Europe/Asia
                ['South Africa', 'Norway'],
                ['Morocco', 'Finland'],
                ['Egypt', 'United Kingdom'],
                ['Nigeria', 'Japan'],
                ['Kenya', 'Sweden'],
                
                // Additional diverse pairs
                ['Iceland', 'Thailand'],
                ['Madagascar', 'Poland'],
                ['Uruguay', 'Kazakhstan'],
                ['Paraguay', 'Ukraine'],
                ['Bolivia', 'Romania']
            ];
            
            // Filter pairs to ensure both countries exist in our data
            const availablePairs = validChallengePairs.filter(([start, end]) => 
                countryNames.includes(start) && countryNames.includes(end)
            );
            
            if (availablePairs.length === 0) {
                // Fallback to original method but with distance check
                return findValidPairWithMinDistance();
            }
            
            const pairIndex = dayOfYear % availablePairs.length;
            return availablePairs[pairIndex];
        }

        // Helper function to find a valid pair with minimum distance when predefined pairs fail
        function findValidPairWithMinDistance() {
            const majorCountries = countryNames.filter(name => {
                const country = getCountryData(name);
                return country && country.population > 5000000; // Countries with >5M population
            });
            
            // Try to find a pair that's at least 4 steps apart
            for (let attempts = 0; attempts < 50; attempts++) {
                const start = majorCountries[Math.floor(Math.random() * majorCountries.length)];
                const end = majorCountries[Math.floor(Math.random() * majorCountries.length)];
                
                if (start !== end) {
                    const pathKey = `${start}-${end}`;
                    if (!pathCache.has(pathKey)) {
                        const path = findOptimalPath(start, end);
                        pathCache.set(pathKey, path);
                    }
                    
                    const path = pathCache.get(pathKey);
                    if (path && path.length >= 5) { // 5 countries = 4 steps minimum
                        return [start, end];
                    }
                }
            }
            
            // Ultimate fallback
            return ['France', 'China'];
        }

        // BFS pathfinding algorithm to find optimal route
        function findOptimalPath(start, end) {
            if (start === end) return [start];
            
            // Check cache first
            const cacheKey = `${start}-${end}`;
            if (pathCache.has(cacheKey)) {
                return pathCache.get(cacheKey);
            }
            
            const queue = [[start]];
            const visited = new Set([start]);
            
            while (queue.length > 0) {
                const path = queue.shift();
                const current = path[path.length - 1];
                const neighbors = getNeighbors(current);
                
                for (const neighbor of neighbors) {
                    if (neighbor === end) {
                        const resultPath = [...path, neighbor];
                        pathCache.set(cacheKey, resultPath);
                        return resultPath;
                    }
                    
                    if (!visited.has(neighbor)) {
                        visited.add(neighbor);
                        queue.push([...path, neighbor]);
                    }
                }
                
                // Limit search to prevent infinite loops for disconnected components
                if (visited.size > 150) break;
            }
            
            pathCache.set(cacheKey, null);
            return null; // No path found
        }

        function initializeGame() {
            initMap();
            const [start, end] = getDailyChallengeFromData();
            startCountry = start;
            endCountry = end;
            currentPath = [startCountry];
            
            // Calculate optimal path and set attempts
            optimalPath = findOptimalPath(startCountry, endCountry);
            if (optimalPath) {
                const optimalLength = optimalPath.length - 1;
                maxAttempts = Math.max(optimalLength + 5, 10); // Ensure minimum 10 attempts
                attempts = maxAttempts;
                document.getElementById('optimalLength').textContent = optimalLength;
            } else {
                // Fallback if no path found (shouldn't happen with our curated pairs)
                maxAttempts = 15;
                attempts = 15;
                document.getElementById('optimalLength').textContent = '?';
            }
            
            document.getElementById('startCountry').textContent = startCountry;
            document.getElementById('endCountry').textContent = endCountry;
            document.getElementById('startInPath').textContent = startCountry;
            document.getElementById('attempts').textContent = attempts;
            
            updateMapMarkers();
            updatePathVisual();
            setupEventListeners();
        }

        function initMap() {
            if (map) {
                map.remove();
            }
            
            map = L.map('worldMap', {
                center: [20, 0],
                zoom: 2,
                zoomControl: true,
                scrollWheelZoom: true,
                doubleClickZoom: true
            });

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(map);
        }

        function addMarkerToMap(countryName, color, size = 12) {
            const coords = getCountryCoords(countryName);
            if (!coords) return null;
            
            const [lat, lng] = coords;
            const marker = L.circleMarker([lat, lng], {
                color: 'white',
                fillColor: color,
                fillOpacity: 0.9,
                radius: size,
                weight: 3
            }).addTo(map);
            
            marker.bindPopup(`<b>${countryName}</b>`);
            return marker;
        }

        function updateMapMarkers() {
            // Clear existing markers
            pathMarkers.forEach(marker => map.removeLayer(marker));
            pathMarkers = [];

            // Add start marker (green)
            const startMarker = addMarkerToMap(startCountry, '#4ecdc4', 15);
            if (startMarker) pathMarkers.push(startMarker);

            // Add end marker (red)
            const endMarker = addMarkerToMap(endCountry, '#ff6b6b', 15);
            if (endMarker) pathMarkers.push(endMarker);

            // Add path markers (blue)
            currentPath.slice(1, -1).forEach(country => {
                const marker = addMarkerToMap(country, '#45b7d1', 10);
                if (marker) pathMarkers.push(marker);
            });

            // Draw lines between path countries
            if (currentPath.length > 1) {
                const pathCoords = currentPath.map(country => getCountryCoords(country)).filter(coords => coords);
                if (pathCoords.length > 1) {
                    const polyline = L.polyline(pathCoords, {color: '#ffd700', weight: 4, opacity: 0.8}).addTo(map);
                    pathMarkers.push(polyline);
                }
            }
        }

        function updatePathVisual() {
            const pathVisual = document.getElementById('pathVisual');
            pathVisual.innerHTML = '';

            currentPath.forEach((country, index) => {
                const countryDiv = document.createElement('div');
                countryDiv.className = 'path-country';
                countryDiv.textContent = country;

                if (country === startCountry) {
                    countryDiv.style.background = 'linear-gradient(135deg, #4ecdc4, #45b7d1)';
                } else if (country === endCountry) {
                    countryDiv.style.background = 'linear-gradient(135deg, #ff6b6b, #ee5a24)';
                } else {
                    countryDiv.style.background = 'linear-gradient(135deg, #96ceb4, #feca57)';
                }

                pathVisual.appendChild(countryDiv);

                if (index < currentPath.length - 1) {
                    const arrow = document.createElement('div');
                    arrow.className = 'path-arrow';
                    arrow.textContent = '→';
                    pathVisual.appendChild(arrow);
                }
            });

            // Update stats
            document.getElementById('pathLength').textContent = Math.max(0, currentPath.length - 1);
            
            // Check if we can finish the path
            const finishBtn = document.getElementById('finishPathBtn');
            const lastCountry = currentPath[currentPath.length - 1];
            const canFinish = lastCountry !== endCountry && getNeighbors(lastCountry).includes(endCountry);
            finishBtn.disabled = !canFinish;
        }

        function setupEventListeners() {
            const countryInput = document.getElementById('countryInput');
            const suggestions = document.getElementById('suggestions');
            const addBtn = document.getElementById('addCountryBtn');
            const finishBtn = document.getElementById('finishPathBtn');
            const resetBtn = document.getElementById('resetPathBtn');
            const newGameBtn = document.getElementById('newGameBtn');

            // Country input with suggestions
            countryInput.addEventListener('input', function() {
                const value = this.value.toLowerCase().trim();
                suggestions.innerHTML = '';
                
                if (value.length < 2) {
                    suggestions.style.display = 'none';
                    return;
                }

                const matches = countryNames.filter(country => 
                    country.toLowerCase().includes(value) && !currentPath.includes(country)
                ).slice(0, 8);

                if (matches.length > 0) {
                    suggestions.style.display = 'block';
                    matches.forEach(country => {
                        const div = document.createElement('div');
                        div.className = 'suggestion-item';
                        div.textContent = country;
                        div.addEventListener('click', () => {
                            countryInput.value = country;
                            suggestions.style.display = 'none';
                            window.playClickSound && window.playClickSound();
                        });
                        suggestions.appendChild(div);
                    });
                } else {
                    suggestions.style.display = 'none';
                }
            });

            // Hide suggestions when clicking outside
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.search-container')) {
                    suggestions.style.display = 'none';
                }
            });

            // Add country to path
            addBtn.addEventListener('click', function() {
                window.playClickSound && window.playClickSound();
                addCountryToPath();
            });

            // Enter key to add country
            countryInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    window.playClickSound && window.playClickSound();
                    addCountryToPath();
                }
            });

            // Finish path
            finishBtn.addEventListener('click', function() {
                window.playClickSound && window.playClickSound();
                finishPath();
            });

            // Reset path
            resetBtn.addEventListener('click', function() {
                window.playClickSound && window.playClickSound();
                resetPath();
            });

            // New game
            newGameBtn.addEventListener('click', function() {
                window.playClickSound && window.playClickSound();
                newGame();
            });
        }

        function addCountryToPath() {
            const countryInput = document.getElementById('countryInput');
            const countryName = countryInput.value.trim();
            
            if (!countryName) {
                alert('Please enter a country name!');
                return;
            }

            // Check if country exists
            if (!countryNames.includes(countryName)) {
                alert('Country not found! Please check the spelling.');
                return;
            }

            // Check if country is already in path
            if (currentPath.includes(countryName)) {
                alert('This country is already in your path!');
                return;
            }

            // Check if country is the end country
            if (countryName === endCountry) {
                alert('Use "Complete Journey" button to finish your path to the destination!');
                return;
            }

            // Check if the country borders the last country in the path
            const lastCountry = currentPath[currentPath.length - 1];
            const neighbors = getNeighbors(lastCountry);
            
            if (!neighbors.includes(countryName)) {
                alert(`${countryName} does not border ${lastCountry}. Please choose a neighboring country.`);
                return;
            }

            // Add country to path
            currentPath.push(countryName);
            attempts--;
            document.getElementById('attempts').textContent = attempts;
            
            countryInput.value = '';
            document.getElementById('suggestions').style.display = 'none';
            
            updatePathVisual();
            updateMapMarkers();

            // Check if we've run out of attempts
            if (attempts <= 0) {
                endGame(false);
            }
        }

        function finishPath() {
            const lastCountry = currentPath[currentPath.length - 1];
            const neighbors = getNeighbors(lastCountry);
            
            if (neighbors.includes(endCountry)) {
                currentPath.push(endCountry);
                updatePathVisual();
                updateMapMarkers();
                endGame(true);
            } else {
                alert(`${lastCountry} does not border ${endCountry}!`);
            }
        }

        function resetPath() {
            currentPath = [startCountry];
            attempts = maxAttempts;
            document.getElementById('attempts').textContent = attempts;
            document.getElementById('countryInput').value = '';
            document.getElementById('suggestions').style.display = 'none';
            updatePathVisual();
            updateMapMarkers();
        }

        function endGame(won) {
            gameCompleted = true;
            const gameOverDiv = document.getElementById('gameOver');
            const titleElement = document.getElementById('gameOverTitle');
            const scoreElement = document.getElementById('scoreDisplay');
            
            if (won) {
                titleElement.textContent = 'Path Complete!';
                titleElement.className = 'win';
                const pathLength = currentPath.length - 1;
                const optimalLength = optimalPath ? optimalPath.length - 1 : '?';
                const efficiency = optimalPath ? Math.round((optimalLength / pathLength) * 100) : 0;
                scoreElement.innerHTML = `You connected <strong>${startCountry}</strong> to <strong>${endCountry}</strong><br>in <strong>${pathLength}</strong> step${pathLength === 1 ? '' : 's'}!<br>Journey Efficiency: <strong>${efficiency}%</strong>`;
                
                // Play win sound and create particle effect
                window.playWinSound && window.playWinSound();
                createWinningEffect();
            } else {
                titleElement.textContent = 'Journey Incomplete!';
                titleElement.className = 'lose';
                scoreElement.innerHTML = `Your adventure ran out of moves!<br>Plan a different route and try again.`;
            }

            showOptimalPath();
            gameOverDiv.style.display = 'block';
            
            // Disable input elements
            document.getElementById('countryInput').disabled = true;
            document.getElementById('addCountryBtn').disabled = true;
            document.getElementById('finishPathBtn').disabled = true;
        }

        function newGame() {
            // Reset everything
            gameCompleted = false;
            currentPath = [];
            
            // Get new challenge
            const [start, end] = getDailyChallengeFromData();
            startCountry = start;
            endCountry = end;
            currentPath = [startCountry];
            
            // Calculate new optimal path and attempts
            optimalPath = findOptimalPath(startCountry, endCountry);
            if (optimalPath) {
                const optimalLength = optimalPath.length - 1;
                maxAttempts = Math.max(optimalLength + 5, 10);
                attempts = maxAttempts;
                document.getElementById('optimalLength').textContent = optimalLength;
            } else {
                maxAttempts = 15;
                attempts = 15;
                document.getElementById('optimalLength').textContent = '?';
            }
            
            // Update UI
            document.getElementById('startCountry').textContent = startCountry;
            document.getElementById('endCountry').textContent = endCountry;
            document.getElementById('attempts').textContent = attempts;
            document.getElementById('gameOver').style.display = 'none';
            document.getElementById('countryInput').disabled = false;
            document.getElementById('addCountryBtn').disabled = false;
            document.getElementById('countryInput').value = '';
            document.getElementById('suggestions').style.display = 'none';
            
            updatePathVisual();
            updateMapMarkers();
        }

        // Calculate and display optimal path after game ends
        function showOptimalPath() {
            const optimalDiv = document.getElementById('optimalPathInfo');
            
            if (optimalPath && optimalPath.length > 0) {
                const optimalLength = optimalPath.length - 1;
                optimalDiv.innerHTML = `
                    <h4>Optimal Journey (${optimalLength} step${optimalLength === 1 ? '' : 's'}):</h4>
                    <p><strong>${optimalPath.join(' → ')}</strong></p>
                    <p style="margin-top: 10px; font-size: 0.9em; color: #4ecdc4;">
                        You had ${maxAttempts} attempts (optimal + 5 bonus moves)
                    </p>
                `;
            } else {
                optimalDiv.innerHTML = '<h4>No direct path found between these countries.</h4>';
            }
        }
    </script>
</body>
</html>
